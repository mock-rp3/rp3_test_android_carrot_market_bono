# 📌 API Sheet
> ### [Carrot Market API](https://docs.google.com/spreadsheets/d/1AN8mMcLtqntN6YwmVyS9J1ptAL1yD-AK/edit#gid=990061567)    

# 📌 일부 화면 Preview
![1](https://user-images.githubusercontent.com/73240332/131107893-dff930b5-4a81-49c5-9cd7-d9a569fd8bcb.PNG)
![2](https://user-images.githubusercontent.com/73240332/131107900-084d7119-9455-44ee-8557-0e50877cf49c.PNG)
![3](https://user-images.githubusercontent.com/73240332/131107908-e421432c-7f38-4fad-88f7-8b5dea46c3a8.PNG)
![4](https://user-images.githubusercontent.com/73240332/131107911-5c350162-e039-4645-9dad-49e3d7f4922a.PNG)



<br />

# 📌 1주차 목표 작업 범위
> _2021/08/14 ~ 2021/08/17_ 
- [x] 로그인 화면 _( 08/14 )  → **( 08/16 )**_
- [x] 회원가입 화면 _( 08/14 ) → **( 08/16 )**_
- [x] 홈 화면 _( 08/15 ) → **( 08/16 )**_
- [x] 스플래쉬 화면 _**( 08/17 )**_
- [x] 뼈대 레이아웃 구성(네비게이션 탭 등) _( 08/14 ) → **( 08/16 )**_
- [x] 이미지 리소스 구하기 
- [x] 자동 로그인 구현 **( 08/20 )**
> API
- [ ] Open API로 도로명 주소 가져오기 >> 나중에 해보기
- [x] 회원가입 API 연동 _**( 08/16 )**_  >>> 로그인 및 회원가입 통합 API
- [x] 로그인 API 연동 >> 서버가 열리면 테스트 하기 >> _**( 08/17 )**_

# 📌 2주차 목표 작업 범위
> _2021/08/17 ~ 2021/08/24_     
> 개인 목표: 하루에 1.5개 완성하기 ( 17 😎 / 18 😎 / 19 😎 / 20 😭 / 21 😭 / 22 😎 / 23 😎 )

<br />    

> 레이아웃    
- [x] 상품 디테일 화면 **_( 08/17 )_**
- [x] 나의 당근 페이지 _( 08/18 ) → **( 08/19 )**_
- [x] 판매내역 _( 08/19 )_
- [x] 상품 등록 _( 08/19 )_
- [x] 카테고리  _( 08/20 )_
- [x] 검색화면 _( 08/22 )_ 
- [x] 앱 설정 _( 08/20 )_
- [x] 회원가입 화면 다시 구현하기 **_( 08/18 )_**
- [x] 자동 로그인
- [x] 동네생활

> API
- [x] 나의 당근 페이지 API  _**( 08/19 )**_
- [x] 새로 작성된 회원가입 API >> 서버가 열리면 테스트 하기 **_( 08/18 )_**
- [x] 새로 작성된 로그인 API **_( 08/19 )_**
- [x] 전체 게시글 조회 API >> 서버가 열리면 테스트 하기 **_( 08/21 )_**
- [x] 상품 디테일 화면 API  _( 08/22 )_ >> Image를 vp2에 연결시키는 방법을 모르겠음 **( 08/26 )**
- [x] 판매글 작성 API >> 메인화면에 반영되게하는 방법을 모르겠음 >> 서버 문제 >> 서버에 수정요청 후 정상 반영 **( 08/23 )**
- [x] 특정 유저 닉네임으로 검색 API  **_( 08/23 )_**
- [x] 게시글 제목으로 검색 API  **_( 08/23 )_**

# 📌 마지막 목표 작업 범위
> _2021/08/24 ~ 2021/08/27_    

> [firebase](https://console.firebase.google.com/project/carrot-market-b4479/overview)      
- [x] 갤러리에서 불러온 사진 firestore에 저장하기    
![image](https://user-images.githubusercontent.com/73240332/130762753-701ab915-7bb2-44c8-9da2-08f95626d625.png)
- [x] 갤러리의 사진을 불러올 때 users-permission 허용, 거절 받기


> 레이아웃
- [x] 판매내역 
- [x] 검색화면 
- [x] 동네생활
- [x] 카테고리 선택 시 나오는 화면


> API
- [x] 게시글 삭제하기 API
- [x] 게시글 수정하기 API
- [x] 유저 프로필 변경 API
- [x] 카테고리 조회 API
- [x] 상품 판매글 조회수 증가 API
- [x] 랜덤매물 조회 API
- [x] 판매중 조회 API
- [x] 상품 게시글 관심 설정 API 
- [x] 상품 게시글 관심 해제 API
- [ ] 판매 게시글 상태 변경 API >> 엮긴 했는데 productIdx 안 받아와짐 변경이 안되서 포기
- [x] 동네생활 조회 API
- [x] 동네생활 글쓰기 API
- [x] 로그인 및 회원가입 통합 API


<br />

# 📌 개발일지
> _2021/08/14 ~ 2021/08/27_ 까지의 과정을 담은 개발일지 
## 2021년 08월 14일 🌞
- 개발환경 구축 ( 70% ✔)
  - Sourcetree 사용에 어려움이 있어 **GitHub Desktop** 으로 변경하여 진행하도록 함.
- 뼈대 레이아웃 구성 ( 50 % ✔)

## 2021년 08월 15일 🌞💧
- 개발환경 구축 ( 100% ✔)
- 로그인 화면 구현 ( 90% ✔)
- 이미지 리소스 구하기

## 2021년 08월 16일 🌞
- 로그인 화면 구현 **( 100% ✔)**
- 회원가입 화면 구현 **( 100% ✔)**
- 회원가입 API 엮기 ( 90% ✔)
- 홈 화면 **( 100% ✔)**
- 스플래쉬 화면 **( 100% ✔)**
- 뼈대 레이아웃 디테일 구성 **( 100% ✔)**
- 이미지 리소스 구하기

## 2021년 08월 17일 🌪🌧 [1차 피드백]
- 로그인 API 연동 **( 100% ✔ )** 지만 로그인 방식 변경으로 수정하기
- 스플래쉬 화면 **( 100% ✔)**
- 자동 로그인

> ### 📌 1차 피드백 
> - floating action button 메인 액티비티에 구현하기 ( 완료 ✔ )
>   - int로 나눠줘서 동네생활이랑 다르게 나오도록하고, 나머지 프래그먼트 눌렀을 때는 없애주기 ( 완료 ✔ )    
>     - 시도 해본적 없어서 난이도를 모르겠음. 다른 것들 우선 진행하고 시도해볼 예정 ( 아주 간단 )
> - 개발 우선순위의 7번 ~ 10번 사이로 구현해보기    
> - divider 코틀린 코딩 말고 item에 선 하나 그어줘도 됨. ( 완료 ✔ )   
> - 처음 퍼블리싱 퀄리티를 잘 잡아두기 (나중에 해야지 하지말기 !!)


- 🚨 로그인 api를 사용하지 않고 회원가입 api를 사용자 api로 사용하기로 함. (회원가입과 로그인을 동시에 한다.)
```

[소셜 로그인 방식으로 진행]

 → 서버에서 문자 인증방식을 구현하기 어려워, id/pw/profileImage/nickname을 받아 회원가입 후 
   id/pw로 로그인하는 방식으로 상의 후 변경하였으나 (issue 2번 참고) 
   클라에서 기존 디자인을 변경해서 제작해야 하는 어려움이 발생함.
 
    →  로그인/회원가입에서 기존 디자인 방식 (번호 입력 후 인증번호를 받고 인증번호를 입력하면 로그인이 되는 방식)을 사용하되,
       번호는 id, 인증번호는 password로 구현하도록 함. (인증번호는 따로 발급받지 않는다.)
  
        →  서버에서는 구현 어려움을 줄이고, 클라에서는 디자인/퍼포먼스 퀄리티를 높일 수 있게됨 !
      
```
- 상품 디테일 화면 구현 **( 100% ✔)**
- 로그인화면 다시 구현하기
- **[Q]** 서버가 서버를 열여줘야만 작업할 수 있었던 issue가 있었으나, 
  - **[A]** 오늘이나 내일 aws서버로 옮기면 앞으로 서버가 계속 열려있을 거라고 말씀해주심!

## 2021년 08월 18일 🌞🌪
> Thread를 제외하고 삽질없이 착착 진행함 !
- **[Q]**  로그인/회원가입 클라 변경사항 서버에게 전달하고 서버 변경사항 전달받기
  - **[A]**  회원가입 시에는 번호를 아이디, 인증번호를 비밀번호로 받지만 로그인할 때는 일단 DB에 있는 번호라면 로그인되는 구조로 수정했다는 답변 받음 !
- 회원가입 화면 다시 구현하기 **( 100% ✔)** >> editText 디테일 신경쓰기
  - 코틀린에서 제공하는 Timer 사용
  - 글자 지우면 다시 원래 상태로 돌아가게 + 글자 수 충족 못하면 다음으로 못 넘어가게~
  - 커스텀 토스트

- 회원가입 API 다시 엮기  **( 100% ✔)**
- 상품 디테일 화면 디테일 신경쓰기 **( 100% ✔)**
- 나의 당근 페이지 구현하기 **( 70% ✔)**
- 나의 당근 페이지 API 엮기  **( 80% ✔)**
- **[Q]**  나의 당근 페이지 API에 해시태그 값이 없어서 서버에 여쭤봄
  - **[A]**  userInfoIdx(유저 인덱스값)로 생각하고 구현하셨다는 답변을 받음 ! 
  - 유일한 값이니 용도가 맞을 것 같아서 답변대로 진행하도록 함
- **[Q]**  나의 당근 페이지의 주소 값이 비어있어서 GPS 구현 후 추가 해주실건지 여쭤봄
  - **[A]**  주소 데이터는 의논이 필요한 문제로 서버에서 api를 엮을지 클라에서 api를 엮을지 정해보기로 함
  - 우선 텍스트뷰로 남겨놓고 천천히 진행하기로 함



## 2021년 08월 19일 🌞
> 자동 로그인과 나의 당근 페이지 API 엮기에서 삽질을 좀 많이했다. 성공조차 못했다 😥 >> SharedPreferences 이용해서 가볍게 성공했다. _( 8/20 )_
- 로그인 API 다시 엮기  **( 100% ✔)**

- 자동 로그인
- 나의 당근 페이지 API 엮기  **( 50% ✔)**
  - 어제 나의 당근 페이지 API 엮기는 성공했는데, 바로 화면에 표시되는게 안된다. >> path Variable 값을 임의로 입력해주면 성공하는데, 받아오는 방법은 아직 ! _(08/21)_
  - Glide 사용
- 나의 당근페이지 구현 **( 100% ✔)** >> API를 엮어야 하는데 잘 안돼유 >> 성공하긴 했는데 뭔가 부족함
  - 나의 당근 페이지에 있는 목록들을 ~~RecyclerView~~로 구현 해야할지 아니면 그냥 **Linear**로 해줘야할지 모르겠어서 고민 해보기
  - 카테고리 화면같은 경우 앱이 업데이트 돼서 수정이 발생할 경우를 가정해보면 **RecyclerView GridLayoutMananger** 혹은 **GridView** 로 구현하는 것이 적절하다.
  - 사진 받아올 때 oval 모양으로 받아오기 아직 안 함. _( 08/22 )_
- 판매내역 구현 **( 60% ✔)**
  - TabLayout + Viewpager2 연결 성공
- **[Q]** 나의 당근 페이지 같은 경우 로그인 후 나만 볼 수 있는 페이지인데 api 헤더 부분에 jwt같은 토큰이 없어서 내가 아닌 다른 유저들도 인덱스 번호만 입력하면 조회할 수 있다는 생각이 듦
  - **[A]** 서버에게 말씀드렸더니 그 부분을 잠깐 생각 못하셨다고 추가 해주시겠다고 답변을 주심 ( 완료 ✔ )
  - **[A+]** 추가적으로 [프로필 조회] 페이지는 유저 인덱스로만 조회할 수 있도록 해도 괜찮을 거 같아서 추후에 페이지 제작할 때는 이 방식으로 진행하도록 함.
- **[Q]** api를 계속 시도하고 싶은데 오류를 해결하느냐고 시간을 쓰게 됨. 알고보니 서버가 닫혀있어서 발생한 문제. 서버에 불편함을 말씀드림.
  - **[A]** aws로 진행하면 에러도 많이 나고 불안정하여 당분간은 이렇게 진행할 것 같다는 답변을 들음
    - **[Q]** 서버가 닫혀있으면 겪는 불편함을 다시 말씀 드리고 작업 시간대(PM 2:00 ~ AM 3:00) 사이에 서버를 장시간 닫을 경우 미리 알려주실 것을 요청함.
      - **[A]** 서버가 열리고 닫히는 것을 슬랙과 명세서에 알려주시기로 함 >> 자주자주 원활한 소통으로 문제없이 진행 중


## 2021년 08월 20일 🌞🌧
> 건강 Issue,,    

- 상품 등록 구현 **( 70% ✔)**
  - ~~Contextual menu~~, ~~popupMenu ?~~ , **Custom Dialog** ‼ >> 다이얼로그 리스트로 보여주기
- 카테고리 구현  **( 80% ✔)**
- 앱 설정 구현  **( 100% ✔)**
- 자동 로그인 **( 100% ✔)**

## 2021년 08월 21일 🌞
> 꼭 해야하는 일: 이번 주까지 작업했던 것들 검토하며 디테일 더 많이 신경써보기 + 미러로이드 사이즈 고려하기
- 상품 등록 구현 **( 100% ✔)**
- 나의 당근 페이지 API path Variable 값 넘겨주기 // 나의 당근 페이지 API 완료 **( 100% ✔)**
- 전체 게시글 조회 API >> 서버 열리면 확인.. 
 
## 2021년 08월 22일 🌞
> 꼭 해야하는 일: 이번 주까지 작업했던 것들 검토하며 디테일 더 많이 신경써보기    
- **[Q]** 어제 하루종일 + 오늘 점심까지 서버가 닫혀있어서 api 작업을 못했다. api를 엮어둔 페이지는 서버가 닫히면 들어갈 수 없어서 이 상태로는 더이상 작업이 불가능할거 같아 다시 한번 요청 드림
  - **[A]** 어제는 열어놓고 나가신줄 알았다고 하셨다. 오늘도 열어놓으신줄 아셨다 한다..! 앞으로는 계속 서버 유지하실거라는 답변 받음 !

- 이미지들 둥근 모서리로 만들기
- 상품 디테일 화면 API  **( 90% ✔)**
  - 이미지는 하나씩 오는데, vp2에 이미지를 어떻게 넣어줘야될지 모르겠음 ( 완료 ✔ )
  - 유저 온도마다 temIcon 바꾸기 // 아직
- 전체 게시글 조회 API  **( 100% ✔)**
  - **[Q]** ~ 초전, ~ 분전 타임스탬프로 계산된 상태인 데이터를 넘겨주실 수 있는지 여쭤봄 //클라에서도 처리할 수 있으나 서버가 데이터를 가지고 있는게 맞는거 같아서
    - **[A]** 작업 다 마치시고 시간되실 때 해주신다고 말씀해주심. 우선 생성된 날짜 넣어둠 //시간남으면 내가 해보기
  - price 값 int로 넘어오는거 3글자마다 쉼표 찍어주기 >> DecimalFormat 사용해서 구현 
- 로딩 dialog 만들기 
  - progress bar를 사용해서 만들어야 할 것 같은데, 일단 [SpinKitView](https://sseong66.tistory.com/33)로 색상과 모양 바꿔서 적용해놓음
- 판매글 작성 API  **( 70% ✔)** 
  - 엮는건 성공했는데 성공 후 화면에 띄우는걸 못함 ( 서버에서 수정 후 완료 ✔ )

## 2021년 08월 23일 🌧
- 게시글 제목으로 검색 API **( 100% ✔)**

- 특정 유저 닉네임으로 검색 API **( 100% ✔)**
- 검색화면 구현 **( 80% ✔)**
  - 구현하는게 굉장히 어려웠다. tab에 항목을 선택하여 메인에 있는 edt 하나로 검색하는데 이걸 프래그먼트에 어떻게 넘겨주고 어떻게 구현해야할 지 고민이 많았고, 확인을 누르면 get이 전송되도록 하는 방식도 어떻게 구현할지 떠올리기 힘들었다. 또한 edt 안에 디테일한 기능들이 상당히 많아서 최대한 똑같이 구현해보려고 노력했다.
    - 프래그먼트에 데이터를 넘겨줄 때, intent는 액티비티간의 이동이 필요한거 같아서 SharedPreferences를 사용하여 넘겨줬다. >> Bundle로 넘겨주기 !
    - ~~프래그먼트 별 검색은 TabLayoutMediator에서 position == 0 일때, position == 2 일때, 등등 나눠서 코드를 작성해주었다.~~ 실제 앱에서는 프래그먼트 별 검색이 아닌 통합검색으로 사용되는거 같아 수정함.
    - edt에는 setOnEditorActionListener, InputMethodManager, addTextChangedListener 등등 많은 기능을 사용하고, 한국어 자판이 가능하도록 설정해주었다.
  - edt에서 키보드의 확인을 눌렀을 때, 결과가 바로 뜨도록 하는 방법 모르겠음 >> Bundle 사용하기 !
- 판매글 작성 API  **( 70% ✔)** >>  **( 100% ✔)**
  - Activity -> Fragment 데이터 전달에는 intent가 아닌 Bundle을 사용하는거라는데 자꾸 null에러 뜸 데이터가 안 받아지는 듯 //시간 너무 오래씀 >>이거 필요없었음 ! 서버 문제
  - **[Q]** 전체 게시글을 조회하면 더미데이터만 표시되고 판매 등록한 게시물은 안뜬다. 혹시 따로 관리하시는지 여쭤봄
    - **[A]** 따로 관리하지 않고, 등록한 유저 상태가 normal이고, 유저가 등록한 지역 아이디(regionId)가 유저아이디(sellerId)에 맞게 등록해야 되서 그런 것 같음. 더미 데이터에도 regionId를 추가할테니 다시 시도해보라고 답변주심  --> 직접 다시 확인해봤는데 안 된다고 하심 !  post 했을 때 데이터가 들어가는 건 확인되기 때문에 불러오는 것에서 뭔가 문제가 생긴 것 같다고 답변주심 --> 수정 후 알려주신다고 함!! 
      - 우선 나중 순위로 미루고 api가 수정된 후 작업해보기
      - **수정 후 테스트 했을 때 코드 수정없이 정상적으로 업로드 됨!** ( 완료 ✔ )
- 전체적인 디테일 수정


## 2021년 08월 24일 🌧 [2차 피드백]
> ### 📌 2차 피드백 
> - 스크롤되면 상단바 변하는거 -> 리스너 통해서 처음 시작할 때 두가지로 만들고 visible 변경하는 방식으로 해도 됨    
> [개발 우선 순위]
> - 스크롤링 액티비티 >> 새로 액티비티 파서 스크롤링 액티비티 구조 뜯어보기 ( 완료 ✔ )    
> - 파이어베이스 이미지 >> 중고게시글 추가 수정 //파이어베이스 ( 완료 ✔ )    
> - 화면 개수, api 개수 늘려보기    

- 파이어베이스 연동 ( 완료 ✔ )
-  스크롤 레이아웃 뜯어보기 ( 완료 ✔ )


<br />

## 2021년 08월 25일 ☁
> 피드백 내용 반영하기    
- 갤러리에서 불러온 사진 firestore에 저장하기 ( 완료 ✔ )
 
- 유저 프로필 변경 API **( 100% ✔)**
- 판매글 수정 API 연동 **( 100% ✔)**
  - **[Q]** 사진 변경은 원래 안되는지? 
    - **[A]** 사진 변경방법은 쿼리문이 꼬여서 안된다하심
- 판매글 삭제 API 연동 **( 100% ✔)** >> 이지만 서버에서 게시글마다 status 값을 주지 않아 삭제된 상태인 게시물도 앱 상에서 보이게 된다. 
  - **[Q]** 서버에 게시글마다 status 값을 response로 주시길 요청함
    - **[A]** 상태 관리는 서버에서 하고 있고, deleted 된 상품은 표시 안되도록 해놓았음 
      - **[Q]** 그래도 표시된다. >> 수정해주심 ! ( 완료 ✔ )
- **[Q]** PATCH, DELETE가 안돼요 ㅠ
  - **[A]**  뒤에 포트 번호 넣어줘야 함. get에서는 포트 번호 안 넣어도 작동하는데 patch, post, delete는 뭔가 잘못된 것 같다. 고치려면 서버를 갈아야 해서 서버 개발팀장과 상의해서 그대로 가기로 했음! 작성하다 보면 헷갈리실 테니 그냥 포트번호 붙여서 작업하길 권고 >> 포트번호 넣기로 ! ( 수정완료 ✔ )
-  상품 판매글 조회수 증가 API **( 100% ✔)**
  - **[Q]** 조회수는 상세조회의 response에 포함되있지 않아서 포함되어야하는 이유와 함께 요청 드림 
    - **[A]** response에 viewCount로 표시해주시기로 함 ! ( 수정완료 ✔ ) 
- 카테고리 조회 API 연동 **( 100% ✔)**
- 랜덤매물 조회 API **( 100% ✔)**
- 판매내역 레이아웃 완성하기 ( 완료 ✔ )
- 판매중 조회 API **( 100% ✔)**
- 상품 게시글 관심 설정 API  **( 100% ✔)**
- 상품 게시글 관심 해제 API  **( 100% ✔)** >> tag 값으로 둘이 상태 변경
  -  Non-body HTTP method cannot contain @Body. 에러 발생 >> ( 완료 ✔ )
-  판매 게시글 상태 변경 API **( 80% ✔)**
   - **[Q]** 판매중 조회 API에 productId가 response 되어야 이 API를 엮을 수 있어서 요청드림


## 2021년 08월 26일 🌞
> 미뤄뒀던 것들 해결해놓기    
- vp2에 이미지 연결 
- 프로필 변경 시 에러가 뜨고 앱이 꺼지는 문제 해결 
- 갤러리에서 이미지 가져와야 하는 페이지에 파이어스토어 다 연결해주기
- 판매하기/수정하기 레이아웃 디테일 수정하기
- 바텀 네비게이션 디테일
- 검색페이지에서 액티비티 > 프래그먼트로 번들을 사용해서 데이터를 바로 넘겨주고 싶은데 자꾸 ViewPager2 does not support direct child views 에러 발생
  - tablayout을 뷰페이지 안에 넣어서 생기는 문제 & 데이터를 바로 vp2에 넣어줘서 생기는 문제라고 한다. 그래서 vp2를 프레임 레이아웃으로 변경 //간단한 화면이 아니라면 데이터 전달도 고려 해야되니 프레임 레이아웃으로 구성하는게 맞는 것 같다.
  - 4일 걸쳐 드디어 성공!!!!!!!!!!!!!!!!!!!!!!!!!
  - 제품 검색도 되고 유저 검색도 된다 !
- API 엮기 완성도 높이기 
- 판매 게시글 상태 변경 API **( 80% ✔)** >> 포기 ! 시도: adapter에 연결해봄 >> productId가 안받아짐
- userIdx랑 해시태그 값 연결하기
- 동네생활 레이아웃 만들기
- 동네생활 조회하기 API **( 100% ✔)**
  - 댓글 있을 때랑 없을 때 구분하기 
- 하트 누르면 커스텀 토스트
- 스크롤 레이아웃 기능 뜯어본걸 기반으로 디테일 화면 상단바 스크롤 시 배경 변경 되도록 적용 
- 동네생활 글쓰기 레이아웃
  - **[변경 구현]** 시간 관계상 카테고리 선택 방식을 dialog 방식으로 구현
- 동네생활 글쓰기 API **( 100% ✔)**
- 온도에 따라서 제품 디테일 화면의 온도 및 기타 색상 바꿔주기


## 2021년 08월 27일 (PM 12:00) 🌞
> 마지막 날    
- 로그인 및 회원가입 통합 API **( 100% ✔)**
  - 2시간전 서버에 업데이트된 ,, api,, 업데이트 후 이 api를 엮지 않으면 나머지 기능들이 작동하지 않는다는걸 1시간 전에 밝혀냈다,,,..  
  - 기존 회원가입 API를 이 API로 변경 구현함..   





# 📌 _Issue_
> 프로젝트를 진행하면서 발생한 문제와 해결 방안       
### 1. 안드로이드와 아이폰의 차이
  - **문제 🤦🏻‍♀ |** 아이폰과 안드로이드의 디자인이 달라 레이아웃 구성에 어려움을 겪음.
  - **해결 🙆🏻‍♀️ |** 안드로이드 공기계를 이용하기로 함 !

### 2. 회원가입 시 실제 받아오는 데이터와 서버 api에서 제공해주는 데이터 차이
  - **문제 🤦🏻‍♀ |** 실제 당근마켓 회원가입에서는 번호만 입력받아 회원가입/로그인을 진행하지만, 협업을 진행하는 서버 측에서 제공해주는 api에서는 아이디/패스워드/프로필 사진을 제공해준다. 레이아웃 구성 시 기존 번호만 받는 레이아웃으로 그대로 진행해야 할지 아니면 서버 api에서 주는 정보대로 구성해야 할지 어려움을 겪음.
  - **원인 💁🏻‍♀️ |** 서버 측 개발팀장님께서 번호 문자 인증이 어려워 일단 아이디/패스워드를 받아 jwt로 로그인하는 방식으로 구현하라고 말씀하셨음. 
  - **해결 🙆🏻‍♀️ |** 서버 개발자 + 서버측 개발팀장님의 의견에 따라 아이디/패스워드을 받아오는 레이아웃으로 재구성 함 !
```
   🚨 원래 방식으로 진행 하기로 다시 변경됨 ! (개발일지 2021년 08월 17일 참고)
```


### 3. API 엮는거에 대한 이해도 부족
  - **문제 🤦🏻‍♀ |** 회원가입 API에 바디 값이 4개 (id/pw/profileImage/nickname)인데, A 액티비티에서 id/pw 값을 받고 B 넘어간 후, B 액티비티에서 profileImage/nickname을 입력받고 싶은데 방법을 찾는데 어려움을 겪음.
  - **뻘짓 🙅🏻‍♀️ |**  A 액티비티에서 id/pw 값을 받고 profileImage/nickname 값을 임의로 입력하여 다음으로 넘어가면 저장된 id/pw 값을 불러오고 다시 요청을 보낸다. >> 요청이 2번 발생함 (X)
  - **원인 💁🏻‍♀️ |**  너무 어렵게 생각했던 것 같다 !
  - **해결 🙆🏻‍♀️ |**  A 액티비티에서 intent로 id/pw값을 넘겨주고 B 액티비티에서 최종 회원가입을 성공시킨다. >> 서버 측에서 적어준 vaildation 처리는 어떻게 되는건지 싶었지만 클라에서도 회원가입이 안되는 로직이 만들어 적용해야 되기 때문에 상관없을 것 같다.

### 4. Fragment에서 RecyclerView 사용하기
  - **문제 🤦🏻‍♀ |**  Activity(RecyclerView)와 Adapter를 연결해줄 때, LoginLocationActivity.kt에서 작성했던 것처럼 this를 context에 넘겨주는데, Fragment에서도 동일하게 코드를 작성해주었더니 thist에 빨간 줄이 발생하였다.
   ``` 
  [Activity] LoginLocationActivity.kt
   
        loginLocationAdapter = LoginLocationAdapter(this, locationArrayList)
        binding.loginLocationRvAround.adapter = loginLocationAdapter
   ```
  - **뻘짓 🙅🏻‍♀️ |**  [1] this를 어떻게든 사용하기 위해 @를 사용해보았다.   [2] 자바에서 처럼 getActivity를 사용해보았다.    [3] Activity()를 사용해보았다.
  - **원인 💁🏻‍♀️ |**  이 부분을 Activity에 작성할 경우 getActivity()를 this로 작성할 수 있는데, 이 클래스는 Fragment를 상속받으므로 해당 Fragment를 관리하는 Activity를 리턴하는 함수(getActivity())를 매개변수로 넘겨야 한다. 
  - **해결 🙆🏻‍♀️ |** 코틀린의 경우 Activity를 이용하여 부모 액티비티의 context 값을 가져와 사용할 수 있다. null 값의 예외처리를 보장하려면 requireActivity() 를 사용해야하므로, **requireActivity()** 사용이 권장된다고 한다. (requireContext()도 해봤는데 됐다!)  //DividerItemDecoration에서 this 값에도 사용하였다. 
   ```
   [Fragment] HomeFragment.kt
   
        homeAdapter = HomeAdapter(requireActivity(), productArrayList)
        binding.homeRv.adapter = homeAdapter
   ```
### 5. Floating Action Button Icon Color
  - **문제 🤦🏻‍♀ |** Floating Action Button의 Icon Color가 변경되지 않고 검정색으로 적용되있다.
  - **원인 💁🏻‍♀️ |** 자동완성에서도 android로 해주는데 왜 이러는지 모르겠음 //v23 이후 설계 지원 라이브러리의 경우 app 이라고 한다.
  - **뻘짓 🙅🏻‍♀️ |**  [1] android:Tint (x)
  - **해결 🙆🏻‍♀️ |** app:Tint="@color/white"로 해결 !


### 6. View 위치와 카드뷰 elevation의 관계 !
  - **문제 🤦🏻‍♀ |** Floating Action Button를 누르면 배경이 투명한 검정색이 되도록 하고 싶어서 View를 넣어줬는데, 전체를 덮는게 아니라 이미지나 탑바의 border 같은 거랑 특히 카드뷰가 View보다 앞에 나와있다. bringToFront()을 해주면 가장 앞으로 나온다길래 해주었는데, 카드뷰는 안 덮였다.
  - **원인 💁🏻‍♀️ |** Android의 뷰에는 X 및 Y 속성 외에도 Z 속성이 있다. Z 값이 더 높은 뷰가 다른 뷰 위에 표시된다고 한다.
  - **해결 🙆🏻‍♀️ |** 검색해도 모르겠어서 혹시나하고 카드뷰의 elevation 값을 조정 해보았더니..  
```
   <androidx.cardview.widget.CardView
        ...
      app:cardElevation="0dp"
        ... />
```
 ### 7. 서버 api URI 대소문자 구별하기 
  - **문제 🤦🏻‍♀ |** 로그인 api를 엮는 중에 포스트맨에서 "error": "Not Found" 가 발생했다.
  - **원인 💁🏻‍♀️ |** uri를 확인해보니 logIn(I 대문자)로 적으셨는데, 여태 login으로 post를 보내고 있었다.
  - **해결 🙆🏻‍♀️ |** 왜 에러가 발생했는지 api 문서를 되짚어 가며 해결 ! 
 
### 8. ScrollView can host only one direct child
  - **원인 💁🏻‍♀️ |** ScrollView 안에 자식은 하나만 존재해야 하는데 여러 개의 View가 있을 경우 발생
  - **해결 🙆🏻‍♀️ |** Layout으로 감싸주기

 ### 9. Switch 색상 바꾸기
  - **문제 🤦🏻‍♀ |** SwitchCompat을 on/off 해줬을 때 간단하게 thumbTint와 trackTint만 색상만 바뀌는데 커스텀 하기위해 drawable에 너무많은 xml을 추가해야 한다.
  - **해결 🙆🏻‍♀️ |** 애뮬레이터에서 직접 on/off를 해보니 on이 되었을 때 colorSecondary 색상으로 변하는 것을 알게되어 colorSecondary 색상을 변경 해주었다.
 

 ### 10. floating action button 프래그먼트마다 다르게 적용해주기
   - **해결 🙆🏻‍♀️ |**  int로 나눠줘서 동네생활이랑 다르게 나오도록하고 클릭 시 액티비티 이동, 나머지 프래그먼트 눌렀을 때는 없애주기 (대략적인 코드고 실제는 다르게 작성함)
```
   [Activity] MainActivity.kt

                private var fabState: Int = 1   
                         
                when (fabState) {
                    1 -> { binding.fabMain.visibility = View.VISIBLE }
                    2 -> { binding.fabMain.setImageResource(R.drawable.pencil_icon)
                        binding.fabMain.visibility = View.VISIBLE }
                                  
                                  ...
                       
                    5 -> { binding.fabMain.visibility = View.GONE }
                }
                
                                  ...
            binding.mainBtmNav.setOnNavigationItemSelectedListener(
            BottomNavigationView.OnNavigationItemSelectedListener { item ->           
                when (item.itemId) {
                    R.id.menu_main_btm_nav_1_on -> {
                    fabState = 1
                                  ... 
                    }
                                  ... 
             }              
```
 - **문제 🤦🏻‍♀ |**  fabState 값은 바텀 네비게이션 아이콘을 클릭 한 후 변경되기 때문에 두 번 클릭해야 적용됐다. 그래서 그냥 바로 코드를 넣어주는 식으로 수정 구현하였다.



 ### 11. Error inflating class com.google.android.material.floatingactionbutton.FloatingActionButton
  - **문제 🤦🏻‍♀ |** 플로팅 액션 버튼이 자꾸 네모로 보이고, 실행도 안되고 바텀 네비게이션 바는 사라졌다. view 객체 생성에 문제가 생긴 것.
  - **해결 🙆🏻‍♀️ |** [다음과 같은 문제](https://jootc.com/p/201908013017)가 발생한 것이었고, themes을 수정해주니 괜찮아졌다.
 ```
  [res/themes.xml]
         <item name="colorPrimary">@null</item>
        <item name="colorPrimaryVariant">@null</item>
                           ⬇
         <item name="colorPrimary">@color/mainColor</item>
        <item name="colorPrimaryVariant">@color/mainColor</item>
 
 ```


 ### 12. 카테고리 메뉴
  - **문제 🤦🏻‍♀ |** 이런 메뉴는 어떤 걸 사용해서 만들까 하면서 검색해보다가 [이 사이트](https://dinfree.com/lecture/android/android_2.4.html)를 보았는데 Context Menu가 내가 찾던 메뉴 여서 만들어 보았다. 근데 Context Menu는 롱클릭을 해야지 메뉴가 생기고 내가 원하는 모습이 아니었다. 그래서 Popup Menu로 만들어 보았다. 클릭하면 나오긴 하는데 내가 원하는 위치에는 안 나온다. 공식문서를 보니 gravity 값을 조정할 수 있다하는데, 생각한 모습과 전혀 다른 모습이었다.
  - **해결 🙆🏻‍♀️ |** 다이얼로그를 리스트로 보여주는 방식을 사용하면 됐다 ..
```
   [Activity] ProductWriteActivity.kt
   
       fun showDialog() {
        val write_cate = resources.getStringArray(R.array.write_cate)

        val builder = AlertDialog.Builder(this)
        builder.setItems(write_cate, DialogInterface.OnClickListener { dialog, which ->
            binding.productWriteTxtCate.text = write_cate[which].toString()
        }
        )
        var alertDialog: AlertDialog = builder.create()
        alertDialog.show()
    }
```

 ### 13. 헤더에 토큰 넣어주기
  - **문제 🤦🏻‍♀ |**  헤더에 토큰 넣어주는게 간단한거 같은데 자꾸 jwt 값이 없다해서 스트레스 받았다.
  - **해결 🙆🏻‍♀️ |**  로그를 찍어보며 원인을 찾았다. 정말 간단하고 시간 투자할 일이 아닌데 멀리 돌아간 것 같다. 다신 같은 삽질을 하지 않아야 겠다!
  ```
       [Interface] ProductsRetrofitInterface.kt
  
       //판매내역 조회 API
        @GET("/app/products/status")
        fun getIng(
          @Header("x-access-token") X_ACCESS_TOKEN:String,
          @Query("status") status:String,
          @Query("sellerId") sellerId: Int
        ):Call<IngResponse>
    
       [Service] MyPageService.kt
    
           fun tryGetMyPage(X_ACCESS_TOKEN:String ,userInfoIdx: Int){ //판매내역 조회라면 status도 넣어주면됨
           val myPageRetrofitInterface =
                ApplicationClass.sRetrofit.create(UsersRetrofitInterface::class.java)
           myPageRetrofitInterface.getMyPage(X_ACCESS_TOKEN,userInfoIdx).enqueue(object:
                          ...
            
       [Fragment] MyPageFragment.kt
           
           sSharedPreferences =
              requireActivity().getSharedPreferences(X_ACCESS_TOKEN, AppCompatActivity.MODE_PRIVATE)
           val jwt = sSharedPreferences.getString(X_ACCESS_TOKEN, null)!!
                   Log.e("jwt10", jwt.toString()) // 값이 잘 넘어오는지 로그 찍어보기 📌

          sSharedPreferences =
              requireActivity().getSharedPreferences("userIdx", AppCompatActivity.MODE_PRIVATE)

          val userIdx = sSharedPreferences.getInt("userIdx", 0)
          Log.e("userIdx2", userIdx.toString()) // 값이 잘 넘어오는지 로그 찍어보기 📌
          MyPageService(this).tryGetMyPage(jwt, userIdx)
  ```
### 14. 3글자 마다 쉼표찍기
  - **해결 🙆🏻‍♀️ |** DecimalFormat 사용하기 >> 이걸로 로그인 때 전화번호 포맷을 ("### #### ####")으로 설정하면 띄어쓰기 되나?
  ```
   [adapter] HomeAdapter.kt
          val decimalFormat = DecimalFormat("###,###")
        val priceDecimalFormat =decimalFormat.format(productDataList[position].price)
        holder.binding.homeItemPrice.text = "$priceDecimalFormat 원"
  ```
### 15. java.net.UnknownServiceException: CLEARTEXT communication to prod.carrotmarket2.shop not permitted by network security policy 
 - **문제 🤦🏻‍♀ |** 서버 url이 https가 아닌 http로 되어있어서 생긴 문제
 - **해결 🙆🏻‍♀️ |**
   ```
   [Manifest]
   android:usesCleartextTraffic="true"
     ```
### 16. 카테고리 선택
 - **문제 🤦🏻‍♀ |** 카테고리 idx를 adapter에 포지션 별로 어떻게 매칭 시켜줘야하는지 
 - **해결 🙆🏻‍♀️ |** position과 categotyIdx를 매칭시켜서 전달시킨다.    
   ```
   [Adapter] HomeCategoryAdapter.kt
   
        holder.binding.homeCategoryItemLl.setOnClickListener {
            var intent = Intent(context, CategorySelectActivity::class.java)
            intent.putExtra("categoryName", homeCategoryDataList[position].category_name)
            var category:Int = position+1
            Log.e("categoryAdapter", category.toString())
            intent.putExtra("category",category)
            context.startActivity(intent)
        }
     ```
### 17. Non-body HTTP method cannot contain @Body.
  - **원인 💁🏻‍♀️ |** DELETE는 BODY 값을 포함 하지않는다고 한다.
  - **해결 🙆🏻‍♀️ |**     
```
[Interface] ProductsRetrofitInterface

     @DELETE("/app/products/wish")
              ⬇
     @HTTP(method = "DELETE", path = "/app/products/wish", hasBody = true)
```

### 18. 좋아요 누르기
  - **해결 🙆🏻‍♀️ |** tag 사용하기
  ```
   [Activity] ProductDetailActivity.kt
   
        binding.detailImgHeart.setOnClickListener {
            if (binding.detailImgHeart.tag.toString() == "true") {
                binding.detailImgHeart.setImageResource(R.drawable.heart_icon)
                ProductDetailService(this).tryDeleteWishProduct(requestWishDel)
                binding.detailImgHeart.tag="false"
            } else {
                binding.detailImgHeart.setImageResource(R.drawable.heart_on_icon)
                ProductDetailService(this).tryPostWishProduct(requestWish)
                binding.detailImgHeart.tag="true"
            }
        }
  ```
  ### 19 java.lang.SecurityException: com.example.carrotmarket has no access to content://media/external/images/media/12196
 - **문제 🤦🏻‍♀ |** 퍼미션 문제인거 같아서 퍼미션 요청까지 넣었는데, 코드가 중복으로 이상하게 입력되서 나타난 문제였다. 없애주니 해결 됨
 - **증상 🤦🏻‍♀ |** 프로필은 정상 변경되고, 파이어스토어에도 정상 저장되었으나 앱이 팅겼다.
   
   
 <br />
 
# 📌 참고자료
- [Fragment Context](https://hanyeop.tistory.com/239)
- [Floating action button Animation](https://greimul.tistory.com/29)
- [CardView Z 속성](https://developer.android.com/guide/topics/ui/look-and-feel)
- [Viewpager2 Indicator custom](https://android-dev.tistory.com/12)
- [Timer](https://magicalcode.tistory.com/49)
- [TabLayout+Viewpager2](https://sys09270883.github.io/app/44/)
- [Retrofit-Header](https://hyongdoc.tistory.com/186)
- [안드로이드에서 JWT 사용하기 이해하기 좋은 블로그](https://hyogeun-android.tistory.com/entry/12-Retrofit-%EC%84%9C%EB%B9%84%EC%8A%A4%EC%99%80-%EB%A1%9C%EA%B7%B8%EC%9D%B8-%EA%B7%B8%EB%A6%AC%EA%B3%A0-SharedPref)
- [로그인](https://hyogeun-android.tistory.com/entry/12-Retrofit-%EC%84%9C%EB%B9%84%EC%8A%A4%EC%99%80-%EB%A1%9C%EA%B7%B8%EC%9D%B8-%EA%B7%B8%EB%A6%AC%EA%B3%A0-SharedPref)
- [ScrollView can host only one direct child](https://blog.naver.com/PostView.nhn?isHttpsRedirect=true&blogId=credenda&logNo=80152077567)
- [PopupMenu](https://developer.android.com/reference/android/support/v7/widget/PopupMenu.html) (x)
- [Context Menu](https://lktprogrammer.tistory.com/162) (x) >> 길게 눌렀을 때 나오는 메뉴 
- [다이얼로그 리스트로 보여주는 방법](https://aries574.tistory.com/109) (o)
- [Activity, Fragment 간 데이터 주고받기](https://velog.io/@jinny_0422/Android-Fragment-Activity%EA%B0%84-%EB%8D%B0%EC%9D%B4%ED%84%B0%EC%A0%84%EB%8B%AC) //Bundle
- [Activity -> Fragment 데이터 전달](https://juahnpop.tistory.com/225)
- [키보드 올라올 때 뷰도 같이 올라가도록 하기](https://inma06.tistory.com/68) //Manifest android:windowSoftInputMode="adjustResize"
- [파이어베이스에 사진 저장 후 불러오기](https://okky.kr/article/538035?note=1598743)
- [유저 퍼미션 요청](https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&blogId=chandong83&logNo=221616557088)
- [나중에 볼 퍼미션 요청](https://github.com/ParkSangGwon/TedPermission)
- [나중에 볼 퍼미션 요청 블로그](https://gun0912.tistory.com/61)
- [퍼미션](https://dnight.tistory.com/entry/MediaStore-File-%EB%8B%A4%EB%A3%A8%EA%B8%B0-Android-ScopedStorage)
- [안드로이드 firebase glide 안보임 현상](https://okky.kr/article/618085)
- [DELETE에 BODY 값 넣기](https://logcdn.com/general/2909/delete-method-is-not-supportingnon-body-http-method-cannot-contain-body-or-typedoutput)
- [바텀 네비게이션 아이콘 변경](https://lcw126.tistory.com/330)
- [Collapsing Tool bar](https://black-jin0427.tistory.com/16)
= [이미지뷰에 색상 넣기 잘 정리됨](https://leveloper.tistory.com/166)
